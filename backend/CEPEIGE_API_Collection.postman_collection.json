{
	"info": {
		"_postman_id": "cepeige-api-collection-v1",
		"name": "CEPEIGE - Sistema de Registro API",
		"description": "Colección completa de endpoints para el Sistema de Registro CEPEIGE Backend",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "cepeige-dev"
	},
	"item": [
		{
			"name": "🔐 Autenticación",
			"item": [
				{
					"name": "Ping (Public)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/auth/ping",
							"host": ["{{base_url}}"],
							"path": ["auth", "ping"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson).to.have.property('success', true);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Login",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"admin@cepeige.com\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": ["{{base_url}}"],
							"path": ["auth", "login"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has tokens\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson.data).to.have.property('accessToken');",
									"    pm.expect(responseJson.data).to.have.property('refreshToken');",
									"    ",
									"    // Set tokens as environment variables",
									"    pm.environment.set('access_token', responseJson.data.accessToken);",
									"    pm.environment.set('refresh_token', responseJson.data.refreshToken);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Refresh Token",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"refreshToken\": \"{{refresh_token}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/refresh",
							"host": ["{{base_url}}"],
							"path": ["auth", "refresh"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has new access token\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson.data).to.have.property('accessToken');",
									"    ",
									"    // Update access token",
									"    pm.environment.set('access_token', responseJson.data.accessToken);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/logout",
							"host": ["{{base_url}}"],
							"path": ["auth", "logout"]
						}
					}
				},
				{
					"name": "Get Profile",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/profile",
							"host": ["{{base_url}}"],
							"path": ["auth", "profile"]
						}
					}
				},
				{
					"name": "Verify Token",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/verify",
							"host": ["{{base_url}}"],
							"path": ["auth", "verify"]
						}
					}
				},
				{
					"name": "Get Active Sessions",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/sessions",
							"host": ["{{base_url}}"],
							"path": ["auth", "sessions"]
						}
					}
				},
				{
					"name": "Logout All Sessions",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/logout-all",
							"host": ["{{base_url}}"],
							"path": ["auth", "logout-all"]
						}
					}
				}
			]
		},
		{
			"name": "👥 Gestión de Usuarios (Solo Super-Admin)",
			"item": [
				{
					"name": "Create User (Super-Admin Only)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"nuevo@cepeige.com\",\n  \"password\": \"password123\",\n  \"nombres\": \"Nuevo\",\n  \"apellidos\": \"Usuario\",\n  \"roles\": [\"admin\"]\n}"
						},
						"url": {
							"raw": "{{base_url}}/usuarios",
							"host": ["{{base_url}}"],
							"path": ["usuarios"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 403\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([201, 403]);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    pm.test(\"User created successfully\", function () {",
									"        const responseJson = pm.response.json();",
									"        pm.expect(responseJson).to.have.property('success', true);",
									"        pm.expect(responseJson.data).to.have.property('idUsuario');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Users (Super-Admin Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/usuarios",
							"host": ["{{base_url}}"],
							"path": ["usuarios"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 403\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 403]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get User by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/usuarios/{{user_id}}",
							"host": ["{{base_url}}"],
							"path": ["usuarios", "{{user_id}}"]
						}
					}
				},
				{
					"name": "Update User",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"nombres\": \"Nombre Actualizado\",\n  \"apellidos\": \"Apellido Actualizado\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/usuarios/{{user_id}}",
							"host": ["{{base_url}}"],
							"path": ["usuarios", "{{user_id}}"]
						}
					}
				},
				{
					"name": "Delete User",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/usuarios/{{user_id}}",
							"host": ["{{base_url}}"],
							"path": ["usuarios", "{{user_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "📚 Cursos",
			"item": [
				{
					"name": "Create Course (Admin/Super-Admin)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"nombreCortoCurso\": \"PROG-JS-2024\",\n  \"nombreCurso\": \"Programación en JavaScript\",\n  \"modalidadCurso\": \"Virtual\",\n  \"descripcionCurso\": \"Curso completo de JavaScript desde cero\",\n  \"valorCurso\": 299.99,\n  \"fechaInicioCurso\": \"2024-02-01\",\n  \"fechaFinCurso\": \"2024-04-30\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/cursos",
							"host": ["{{base_url}}"],
							"path": ["cursos"]
						}
					}
				},
				{
					"name": "Get All Courses (Admin roles only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/cursos",
							"host": ["{{base_url}}"],
							"path": ["cursos"]
						}
					}
				},
				{
					"name": "Get Available Courses (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - can be enabled for better experience"
							}
						],
						"url": {
							"raw": "{{base_url}}/cursos/disponibles",
							"host": ["{{base_url}}"],
							"path": ["cursos", "disponibles"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has courses array\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson.data).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Course by ID (Admin/Super-Admin)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/cursos/{{course_id}}",
							"host": ["{{base_url}}"],
							"path": ["cursos", "{{course_id}}"]
						}
					}
				},
				{
					"name": "Update Course (Admin/Super-Admin)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"nombreCurso\": \"Programación Avanzada en JavaScript\",\n  \"valorCurso\": 399.99\n}"
						},
						"url": {
							"raw": "{{base_url}}/cursos/{{course_id}}",
							"host": ["{{base_url}}"],
							"path": ["cursos", "{{course_id}}"]
						}
					}
				},
				{
					"name": "Delete Course (Super-Admin Only)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/cursos/{{course_id}}",
							"host": ["{{base_url}}"],
							"path": ["cursos", "{{course_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "👤 Datos Personales",
			"item": [
				{
					"name": "Create Personal Data (Public + Optional Auth)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - improves experience if authenticated"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"ciPasaporte\": \"1234567890\",\n  \"nombres\": \"Juan Carlos\",\n  \"apellidos\": \"Pérez López\",\n  \"numTelefono\": \"+593987654321\",\n  \"correo\": \"juan.perez@email.com\",\n  \"pais\": \"Ecuador\",\n  \"provinciaEstado\": \"Pichincha\",\n  \"ciudad\": \"Quito\",\n  \"profesion\": \"Ingeniero de Sistemas\",\n  \"institucion\": \"Universidad Central\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/datos-personales",
							"host": ["{{base_url}}"],
							"path": ["datos-personales"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response has personal data ID\", function () {",
									"    const responseJson = pm.response.json();",
									"    pm.expect(responseJson.data).to.have.property('idPersona');",
									"    pm.environment.set('personal_data_id', responseJson.data.idPersona);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Personal Data (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - authenticated users may see more details"
							}
						],
						"url": {
							"raw": "{{base_url}}/datos-personales",
							"host": ["{{base_url}}"],
							"path": ["datos-personales"]
						}
					}
				},
				{
					"name": "Search by CI/Passport (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for duplicate validation during enrollment"
							}
						],
						"url": {
							"raw": "{{base_url}}/datos-personales/search?ciPasaporte={{ci_pasaporte}}",
							"host": ["{{base_url}}"],
							"path": ["datos-personales", "search"],
							"query": [
								{
									"key": "ciPasaporte",
									"value": "{{ci_pasaporte}}"
								}
							]
						}
					}
				},
				{
					"name": "Get Personal Data by ID (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment tracking"
							}
						],
						"url": {
							"raw": "{{base_url}}/datos-personales/{{personal_data_id}}",
							"host": ["{{base_url}}"],
							"path": ["datos-personales", "{{personal_data_id}}"]
						}
					}
				},
				{
					"name": "Update Personal Data (Admin Only)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"numTelefono\": \"+593999888777\",\n  \"correo\": \"nuevo.correo@email.com\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/datos-personales/{{personal_data_id}}",
							"host": ["{{base_url}}"],
							"path": ["datos-personales", "{{personal_data_id}}"]
						}
					}
				},
				{
					"name": "Delete Personal Data (Super-Admin Only)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/datos-personales/{{personal_data_id}}",
							"host": ["{{base_url}}"],
							"path": ["datos-personales", "{{personal_data_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "🧾 Datos de Facturación",
			"item": [
				{
					"name": "Create Billing Data (Public + Optional Auth)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment flow"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"razonSocial\": \"Empresa ABC S.A.\",\n  \"identificacionTributaria\": \"1234567890001\",\n  \"telefono\": \"+593987654321\",\n  \"correoFactura\": \"facturacion@empresa.com\",\n  \"direccion\": \"Av. Principal 123, Quito, Ecuador\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/datos-facturacion",
							"host": ["{{base_url}}"],
							"path": ["datos-facturacion"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const responseJson = pm.response.json();",
									"    pm.environment.set('billing_data_id', responseJson.data.idFacturacion);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Billing Data (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - authenticated users may see more details"
							}
						],
						"url": {
							"raw": "{{base_url}}/datos-facturacion",
							"host": ["{{base_url}}"],
							"path": ["datos-facturacion"]
						}
					}
				},
				{
					"name": "Get Billing Data by ID (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment tracking"
							}
						],
						"url": {
							"raw": "{{base_url}}/datos-facturacion/{{billing_data_id}}",
							"host": ["{{base_url}}"],
							"path": ["datos-facturacion", "{{billing_data_id}}"]
						}
					}
				},
				{
					"name": "Update Billing Data (Admin/Contador Only)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"telefono\": \"+593999888777\",\n  \"correoFactura\": \"nueva.facturacion@empresa.com\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/datos-facturacion/{{billing_data_id}}",
							"host": ["{{base_url}}"],
							"path": ["datos-facturacion", "{{billing_data_id}}"]
						}
					}
				},
				{
					"name": "Delete Billing Data (Super-Admin Only)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/datos-facturacion/{{billing_data_id}}",
							"host": ["{{base_url}}"],
							"path": ["datos-facturacion", "{{billing_data_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "📄 Comprobantes",
			"item": [
				{
					"name": "Upload Payment Voucher (Public + Optional Auth)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment flow"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "comprobanteFile",
									"type": "file",
									"src": "/path/to/voucher.pdf"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/comprobantes",
							"host": ["{{base_url}}"],
							"path": ["comprobantes"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const responseJson = pm.response.json();",
									"    pm.environment.set('voucher_id', responseJson.data.idComprobante);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Vouchers (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - authenticated users may see more details"
							}
						],
						"url": {
							"raw": "{{base_url}}/comprobantes?page=1&limit=10",
							"host": ["{{base_url}}"],
							"path": ["comprobantes"],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								}
							]
						}
					}
				},
				{
					"name": "Get Voucher by ID (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment tracking"
							}
						],
						"url": {
							"raw": "{{base_url}}/comprobantes/{{voucher_id}}",
							"host": ["{{base_url}}"],
							"path": ["comprobantes", "{{voucher_id}}"]
						}
					}
				},
				{
					"name": "Delete Voucher (Super-Admin Only)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/comprobantes/{{voucher_id}}",
							"host": ["{{base_url}}"],
							"path": ["comprobantes", "{{voucher_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "📝 Inscripciones",
			"item": [
				{
					"name": "Create Registration (Public + Optional Auth)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment flow"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"idCurso\": {{course_id}},\n  \"idPersona\": {{personal_data_id}},\n  \"idFacturacion\": {{billing_data_id}},\n  \"idComprobante\": {{voucher_id}},\n  \"idDescuento\": null,\n  \"matricula\": false\n}"
						},
						"url": {
							"raw": "{{base_url}}/inscripciones",
							"host": ["{{base_url}}"],
							"path": ["inscripciones"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const responseJson = pm.response.json();",
									"    pm.environment.set('registration_id', responseJson.data.idInscripcion);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Registrations (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - authenticated users may see more details"
							}
						],
						"url": {
							"raw": "{{base_url}}/inscripciones",
							"host": ["{{base_url}}"],
							"path": ["inscripciones"]
						}
					}
				},
				{
					"name": "Get Registration by ID (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment tracking"
							}
						],
						"url": {
							"raw": "{{base_url}}/inscripciones/{{registration_id}}",
							"host": ["{{base_url}}"],
							"path": ["inscripciones", "{{registration_id}}"]
						}
					}
				},
				{
					"name": "Update Registration - Matricular (Admin Only)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"matricula\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/inscripciones/{{registration_id}}",
							"host": ["{{base_url}}"],
							"path": ["inscripciones", "{{registration_id}}"]
						}
					}
				},
				{
					"name": "Delete Registration (Super-Admin Only)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/inscripciones/{{registration_id}}",
							"host": ["{{base_url}}"],
							"path": ["inscripciones", "{{registration_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "💰 Descuentos",
			"item": [
				{
					"name": "Create Discount (Super-Admin Only)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"tipoDescuento\": \"Estudiante\",\n  \"valorDescuento\": 50.00,\n  \"porcentajeDescuento\": 15.00,\n  \"descripcionDescuento\": \"Descuento para estudiantes universitarios\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/descuentos",
							"host": ["{{base_url}}"],
							"path": ["descuentos"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const responseJson = pm.response.json();",
									"    pm.environment.set('discount_id', responseJson.data.idDescuento);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Discounts (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - shows available discounts for public, authenticated users may see additional details"
							}
						],
						"url": {
							"raw": "{{base_url}}/descuentos",
							"host": ["{{base_url}}"],
							"path": ["descuentos"]
						}
					}
				},
				{
					"name": "Get Discount by ID (Public + Optional Auth)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"disabled": true,
								"description": "Optional - for enrollment process"
							}
						],
						"url": {
							"raw": "{{base_url}}/descuentos/{{discount_id}}",
							"host": ["{{base_url}}"],
							"path": ["descuentos", "{{discount_id}}"]
						}
					}
				},
				{
					"name": "Update Discount (Super-Admin Only)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"valorDescuento\": 75.00,\n  \"porcentajeDescuento\": 20.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/descuentos/{{discount_id}}",
							"host": ["{{base_url}}"],
							"path": ["descuentos", "{{discount_id}}"]
						}
					}
				},
				{
					"name": "Delete Discount (Super-Admin Only)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/descuentos/{{discount_id}}",
							"host": ["{{base_url}}"],
							"path": ["descuentos", "{{discount_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "🧾 Facturas",
			"item": [
				{
					"name": "Create Invoice (Contador Only)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"idInscripcion\": {{registration_id}},\n  \"idFacturacion\": {{billing_data_id}},\n  \"valorPagado\": 299.99,\n  \"numeroIngreso\": \"ING-2024-001\",\n  \"numeroFactura\": \"FAC-2024-001\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/facturas",
							"host": ["{{base_url}}"],
							"path": ["facturas"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const responseJson = pm.response.json();",
									"    pm.environment.set('invoice_id', responseJson.data.idFactura);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Invoices (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/facturas?page=1&limit=10&includeRelations=true",
							"host": ["{{base_url}}"],
							"path": ["facturas"],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								},
								{
									"key": "includeRelations",
									"value": "true"
								}
							]
						}
					}
				},
				{
					"name": "Get Invoice by ID (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/facturas/{{invoice_id}}?includeRelations=true",
							"host": ["{{base_url}}"],
							"path": ["facturas", "{{invoice_id}}"],
							"query": [
								{
									"key": "includeRelations",
									"value": "true"
								}
							]
						}
					}
				},
				{
					"name": "Get Invoice by Number (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/facturas/numero-factura/{{invoice_number}}",
							"host": ["{{base_url}}"],
							"path": ["facturas", "numero-factura", "{{invoice_number}}"]
						}
					}
				},
				{
					"name": "Get Invoice by Entry Number (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/facturas/numero-ingreso/{{entry_number}}",
							"host": ["{{base_url}}"],
							"path": ["facturas", "numero-ingreso", "{{entry_number}}"]
						}
					}
				},
				{
					"name": "Get Invoices by Registration ID (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/facturas/inscripcion/{{registration_id}}",
							"host": ["{{base_url}}"],
							"path": ["facturas", "inscripcion", "{{registration_id}}"]
						}
					}
				},
				{
					"name": "Update Invoice (Contador Only)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"verificacionPago\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/facturas/{{invoice_id}}",
							"host": ["{{base_url}}"],
							"path": ["facturas", "{{invoice_id}}"]
						}
					}
				},
				{
					"name": "Verify Payment (Contador Only)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/facturas/{{invoice_id}}/verificar-pago",
							"host": ["{{base_url}}"],
							"path": ["facturas", "{{invoice_id}}", "verificar-pago"]
						}
					}
				},
				{
					"name": "Delete Invoice (Super-Admin Only)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/facturas/{{invoice_id}}",
							"host": ["{{base_url}}"],
							"path": ["facturas", "{{invoice_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "📊 Informes",
			"item": [
				{
					"name": "Get Report Types (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/informes/tipos",
							"host": ["{{base_url}}"],
							"path": ["informes", "tipos"]
						}
					}
				},
				{
					"name": "Get Available Courses for Filters (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/informes/cursos",
							"host": ["{{base_url}}"],
							"path": ["informes", "cursos"]
						}
					}
				},
				{
					"name": "Get Report Statistics (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/informes/estadisticas?fechaInicio={{fecha_inicio}}&fechaFin={{fecha_fin}}&idCurso={{course_id}}&matricula={{matricula_filter}}&verificacionPago={{payment_filter}}",
							"host": ["{{base_url}}"],
							"path": ["informes", "estadisticas"],
							"query": [
								{
									"key": "fechaInicio",
									"value": "{{fecha_inicio}}",
									"description": "Fecha inicio (YYYY-MM-DD)"
								},
								{
									"key": "fechaFin",
									"value": "{{fecha_fin}}",
									"description": "Fecha fin (YYYY-MM-DD)"
								},
								{
									"key": "idCurso",
									"value": "{{course_id}}",
									"description": "ID del curso"
								},
								{
									"key": "matricula",
									"value": "{{matricula_filter}}",
									"description": "true/false"
								},
								{
									"key": "verificacionPago",
									"value": "{{payment_filter}}",
									"description": "true/false"
								}
							]
						}
					}
				},
				{
					"name": "Get Report Data (Admin/Contador Only)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/informes/datos?fechaInicio={{fecha_inicio}}&fechaFin={{fecha_fin}}&idCurso={{course_id}}",
							"host": ["{{base_url}}"],
							"path": ["informes", "datos"],
							"query": [
								{
									"key": "fechaInicio",
									"value": "{{fecha_inicio}}",
									"description": "Fecha inicio (YYYY-MM-DD)"
								},
								{
									"key": "fechaFin",
									"value": "{{fecha_fin}}",
									"description": "Fecha fin (YYYY-MM-DD)"
								},
								{
									"key": "idCurso",
									"value": "{{course_id}}",
									"description": "ID del curso"
								}
							]
						}
					}
				},
				{
					"name": "Generate Report (Excel/PDF) (Admin/Contador Only)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"tipoInforme\": \"inscripciones\",\n  \"formato\": \"excel\",\n  \"fechaInicio\": \"2024-01-01\",\n  \"fechaFin\": \"2024-12-31\",\n  \"idCurso\": {{course_id}},\n  \"matricula\": true,\n  \"verificacionPago\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/informes/generar",
							"host": ["{{base_url}}"],
							"path": ["informes", "generar"]
						}
					}
				},
				{
					"name": "Generate Excel Report (Admin/Contador Only)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"tipoInforme\": \"matriculados\",\n  \"fechaInicio\": \"2024-01-01\",\n  \"fechaFin\": \"2024-12-31\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/informes/excel",
							"host": ["{{base_url}}"],
							"path": ["informes", "excel"]
						}
					}
				},
				{
					"name": "Generate PDF Report (Admin/Contador Only)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"tipoInforme\": \"pagados\",\n  \"fechaInicio\": \"2024-01-01\",\n  \"fechaFin\": \"2024-12-31\",\n  \"verificacionPago\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/informes/pdf",
							"host": ["{{base_url}}"],
							"path": ["informes", "pdf"]
						}
					}
				}
			]
		},
		{
			"name": "🏥 Health Check",
			"item": [
				{
					"name": "Ping",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/ping",
							"host": ["{{base_url}}"],
							"path": ["ping"]
						}
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:5000/api/v1",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "refresh_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "user_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "course_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "personal_data_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "billing_data_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "voucher_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "registration_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "discount_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "invoice_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "ci_pasaporte",
			"value": "1234567890",
			"type": "string"
		},
		{
			"key": "invoice_number",
			"value": "FAC-2024-001",
			"type": "string"
		},
		{
			"key": "entry_number",
			"value": "ING-2024-001",
			"type": "string"
		},
		{
			"key": "fecha_inicio",
			"value": "2024-01-01",
			"type": "string"
		},
		{
			"key": "fecha_fin",
			"value": "2024-12-31",
			"type": "string"
		},
		{
			"key": "matricula_filter",
			"value": "true",
			"type": "string"
		},
		{
			"key": "payment_filter",
			"value": "true",
			"type": "string"
		}
	]
}